ผมได้ปรับปรุงดีไซน์หน้า **Report** ให้มีความ **"Premium & Modern"** มากขึ้น โดยเน้นความสะอาดตา การจัดวางที่เป็นระเบียบ และดูเป็นทางการเหมือนเอกสารจากบริษัทที่ปรึกษาชั้นนำครับ

### สิ่งที่ปรับปรุงด้านดีไซน์ (UI/UX Upgrade):

1. **Modern Dashboard UI:**
* ใช้ **Glassmorphism** (พื้นหลังเบลอ) ในส่วน Header และ Modal
* ใช้ **Soft Shadows & Rounded Corners** ให้ดูทันสมัย สบายตา
* **Typography:** ปรับระยะห่างตัวอักษรและบรรทัดให้อ่านง่ายขึ้น (ใช้ฟอนต์ `Sarabun` สำหรับภาษาไทยในโหมดพิมพ์)


2. **Print Layout (A4 Optimized):**
* **Cover Page Style:** หน้าแรกของรายงานจัดวางแบบ Executive Summary มีกราฟและสรุปผู้บริหาร
* **Two-Column Layout:** จัดวางเนื้อหาแบบ 2 คอลัมน์เพื่อประหยัดพื้นที่และดูสวยงาม
* **Timeline Roadmap:** ดีไซน์ Roadmap ใหม่ให้เป็นเส้นเวลาที่ดูง่าย
* **Status Badges:** ใช้สีเขียว/แดง/เหลือง เพื่อสื่อความหมายสถานะชัดเจน



คุณสามารถ Copy โค้ดนี้ไปทับไฟล์ `index.html` เดิมได้เลยครับ

```html
<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Azure Entra ID Consultant Tool</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600;700&family=Sarabun:wght@400;500;600&display=swap" rel="stylesheet">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: { 
                        sans: ['Prompt', 'sans-serif'],
                        print: ['Sarabun', 'sans-serif'] 
                    },
                    colors: { 
                        brand: { 50: '#f0f9ff', 100: '#e0f2fe', 500: '#0ea5e9', 600: '#0284c7', 800: '#075985', 900: '#0c4a6e' },
                        msBlue: '#0078D4',
                        darkBg: '#0f172a'
                    }
                }
            }
        }
    </script>

    <style>
        body { font-family: 'Prompt', sans-serif; background-color: #f8fafc; color: #334155; }
        .check-item input:checked + span { text-decoration: line-through; color: #94a3b8; }
        [x-cloak] { display: none !important; }
        
        /* Custom Scrollbar */
        .custom-scroll::-webkit-scrollbar { width: 6px; height: 6px; }
        .custom-scroll::-webkit-scrollbar-track { background: transparent; }
        .custom-scroll::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }
        .custom-scroll::-webkit-scrollbar-thumb:hover { background: #94a3b8; }

        /* Animation */
        .fade-in-up { animation: fadeInUp 0.4s ease-out; }
        @keyframes fadeInUp { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* --- PRINT STYLES (A4 Professional) --- */
        @media print {
            @page { size: A4; margin: 0; }
            body { 
                background: white; 
                -webkit-print-color-adjust: exact; 
                print-color-adjust: exact; 
                font-family: 'Sarabun', sans-serif;
                width: 100%;
                font-size: 10.5pt;
                color: #1e293b;
            }
            
            /* Hidden Elements */
            nav, .hero-section, main, .floating-btn, .modal-ui, .no-print { display: none !important; }
            #print-template { display: block !important; }

            /* Page Structure */
            .print-page {
                width: 210mm;
                min-height: 297mm;
                padding: 15mm 15mm;
                margin: 0 auto;
                position: relative;
                page-break-after: always;
                background: white;
            }
            .print-page:last-child { page-break-after: auto; }

            /* Header Design */
            .doc-header {
                border-bottom: 3px solid #0ea5e9;
                padding-bottom: 15px;
                margin-bottom: 25px;
                display: flex;
                justify-content: space-between;
                align-items: flex-end;
            }
            .doc-title { font-size: 24pt; font-weight: 700; color: #0f172a; line-height: 1; }
            .doc-subtitle { font-size: 12pt; color: #64748b; margin-top: 5px; }
            
            /* Components */
            .info-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 25px; }
            .info-card { background: #f8fafc; border: 1px solid #e2e8f0; padding: 12px; border-radius: 6px; }
            
            .section-head {
                font-size: 14pt; font-weight: 700; color: #0284c7;
                border-left: 4px solid #0284c7; padding-left: 10px;
                margin: 25px 0 15px 0;
            }

            .chart-container-print {
                display: flex; gap: 20px; height: 180px; margin-bottom: 25px;
            }
            .chart-box { flex: 1; border: 1px solid #e2e8f0; border-radius: 8px; padding: 10px; display: flex; align-items: center; justify-content: center; }

            .analysis-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
            .finding-box { border-radius: 8px; padding: 15px; font-size: 10pt; height: 100%; }
            .finding-box.pain { background: #fff1f2; border: 1px solid #fecdd3; }
            .finding-box.rec { background: #eff6ff; border: 1px solid #bfdbfe; }

            .roadmap-box { background: #f0fdf4; border: 1px solid #bbf7d0; padding: 15px; border-radius: 8px; font-family: 'Sarabun', monospace; font-size: 10pt; white-space: pre-wrap; }

            .audit-table { width: 100%; border-collapse: collapse; font-size: 9pt; margin-top: 10px; }
            .audit-table th { background: #f1f5f9; text-align: left; padding: 8px; color: #475569; border-bottom: 2px solid #cbd5e1; }
            .audit-table td { padding: 8px; border-bottom: 1px solid #e2e8f0; vertical-align: top; }
            
            .footer { position: absolute; bottom: 10mm; left: 0; right: 0; text-align: center; font-size: 8pt; color: #94a3b8; border-top: 1px solid #e2e8f0; padding-top: 10px; margin: 0 15mm; }
        }
        #print-template { display: none; }
    </style>
</head>
<body x-data="troubleshooter()">

    <nav class="bg-white/80 backdrop-blur-md border-b border-slate-200 sticky top-0 z-40 no-print">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-16 flex justify-between items-center">
            <div class="flex items-center gap-3">
                <div class="bg-brand-600 text-white p-2 rounded-lg shadow-sm"><i class="fa-brands fa-microsoft text-xl"></i></div>
                <div>
                    <h1 class="font-bold text-lg text-slate-800 leading-tight">Entra ID <span class="text-brand-600">Consultant</span></h1>
                    <p class="text-[10px] text-slate-500 uppercase tracking-wide">Audit & Assessment Tool</p>
                </div>
            </div>
            <div class="flex items-center gap-4">
                <span class="text-xs text-slate-400 bg-slate-100 px-3 py-1 rounded-full">v3.0 Pro</span>
                <a href="#" class="text-sm text-slate-600 hover:text-brand-600 transition-colors">By Mr.Abdulloh</a>
            </div>
        </div>
    </nav>

    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 no-print">
        
        <div class="flex overflow-x-auto gap-2 pb-4 mb-2 custom-scroll">
            <template x-for="tab in tabs">
                <button @click="changeTab(tab.id)" 
                    :class="activeTab === tab.id ? 'bg-brand-600 text-white shadow-md' : 'bg-white text-slate-600 hover:bg-slate-50 border border-slate-200'"
                    class="px-5 py-2.5 rounded-xl text-sm font-medium whitespace-nowrap transition-all flex items-center gap-2">
                    <i :class="tab.icon"></i>
                    <span x-text="tab.label"></span>
                </button>
            </template>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-12 gap-6 items-start">
            
            <div class="lg:col-span-8 space-y-4">
                <div class="bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden min-h-[600px] flex flex-col">
                    <div class="p-6 border-b border-slate-100 flex justify-between items-center bg-slate-50/50">
                        <h2 class="text-xl font-bold text-slate-800 flex items-center gap-2">
                            <i :class="currentTabInfo.icon" class="text-brand-600"></i>
                            <span x-text="currentTabInfo.label"></span>
                        </h2>
                        <a :href="currentTabInfo.link" target="_blank" class="text-xs text-brand-600 hover:text-brand-800 font-medium flex items-center gap-1">
                            Reference Docs <i class="fa-solid fa-external-link-alt"></i>
                        </a>
                    </div>
                    
                    <div class="p-6 flex-1">
                        <div class="space-y-3">
                            <template x-for="(item, index) in currentTabInfo.checklist" :key="index">
                                <div @click="highlightedItem = item" 
                                     class="group p-4 rounded-xl border cursor-pointer transition-all duration-200 relative overflow-hidden"
                                     :class="highlightedItem === item ? 'bg-brand-50 border-brand-200 shadow-sm' : 'bg-white border-slate-100 hover:border-brand-200 hover:shadow-sm'">
                                    
                                    <div class="flex items-start gap-4 z-10 relative">
                                        <div class="pt-1">
                                            <input type="checkbox" :value="item.text" x-model="report.steps" 
                                                   class="w-5 h-5 text-brand-600 rounded border-slate-300 focus:ring-brand-500 cursor-pointer">
                                        </div>
                                        <div class="flex-1">
                                            <span class="font-medium text-slate-700 block group-hover:text-brand-700 transition-colors" x-text="item.text"></span>
                                            <span class="text-xs text-slate-400 mt-1 block truncate" x-show="highlightedItem !== item">Click to view setup guide...</span>
                                        </div>
                                        <i class="fa-solid fa-chevron-right text-xs text-slate-300 mt-1 group-hover:text-brand-400"></i>
                                    </div>
                                    
                                    <div class="absolute bottom-0 left-0 h-1 bg-brand-500/10 transition-all duration-300" 
                                         :style="`width: ${highlightedItem === item ? '100%' : '0%'}`"></div>
                                </div>
                            </template>
                        </div>
                    </div>
                </div>
            </div>

            <div class="lg:col-span-4 space-y-6 sticky top-24">
                
                <div class="bg-slate-900 text-white rounded-2xl shadow-xl overflow-hidden min-h-[400px] flex flex-col relative">
                    <div class="absolute top-0 right-0 w-64 h-64 bg-brand-500/20 rounded-full blur-3xl -mr-16 -mt-16 pointer-events-none"></div>
                    <div class="absolute bottom-0 left-0 w-48 h-48 bg-purple-500/20 rounded-full blur-3xl -ml-10 -mb-10 pointer-events-none"></div>

                    <div class="p-6 relative z-10 flex-1 flex flex-col">
                        <div x-show="!highlightedItem" x-transition class="flex-1 flex flex-col items-center justify-center text-center space-y-6">
                            <div class="relative">
                                <svg class="w-32 h-32 transform -rotate-90">
                                    <circle cx="64" cy="64" r="60" stroke="currentColor" stroke-width="8" fill="transparent" class="text-slate-700" />
                                    <circle cx="64" cy="64" r="60" stroke="currentColor" stroke-width="8" fill="transparent" class="text-brand-500 transition-all duration-1000" 
                                            :stroke-dasharray="377" :stroke-dashoffset="377 - (377 * report.steps.length / totalItems)" />
                                </svg>
                                <div class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 text-center">
                                    <span class="text-3xl font-bold" x-text="Math.round((report.steps.length / totalItems) * 100) + '%'"></span>
                                    <span class="block text-xs text-slate-400">Completion</span>
                                </div>
                            </div>
                            <div>
                                <h3 class="text-lg font-bold mb-1">Audit in Progress</h3>
                                <p class="text-sm text-slate-400 px-4">Select any checklist item on the left to see the detailed setup guide.</p>
                            </div>
                        </div>

                        <div x-show="highlightedItem" x-transition class="flex-1 flex flex-col h-full">
                            <div class="flex justify-between items-start mb-4 border-b border-white/10 pb-4">
                                <h3 class="font-bold text-lg leading-snug pr-4" x-text="highlightedItem?.text"></h3>
                                <button @click.stop="highlightedItem = null" class="text-slate-400 hover:text-white transition-colors"><i class="fa-solid fa-xmark"></i></button>
                            </div>
                            
                            <div class="flex-1 overflow-y-auto pr-2 custom-scroll space-y-5">
                                <div class="bg-white/5 rounded-lg p-3 border border-white/5">
                                    <div class="text-yellow-400 text-xs font-bold uppercase mb-1"><i class="fa-solid fa-lightbulb mr-1"></i> Rationale</div>
                                    <p class="text-sm text-slate-300 leading-relaxed" x-text="highlightedItem?.why"></p>
                                </div>
                                
                                <div>
                                    <div class="text-brand-300 text-xs font-bold uppercase mb-2"><i class="fa-solid fa-book mr-1"></i> Concept</div>
                                    <p class="text-sm text-slate-300 leading-relaxed" x-text="highlightedItem?.guide"></p>
                                </div>

                                <div>
                                    <div class="text-green-400 text-xs font-bold uppercase mb-2"><i class="fa-solid fa-list-check mr-1"></i> Configuration Steps</div>
                                    <ol class="list-decimal pl-4 space-y-2 text-sm text-slate-300">
                                        <template x-for="step in highlightedItem?.steps">
                                            <li class="pl-1 leading-snug"><span x-text="step"></span></li>
                                        </template>
                                    </ol>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="flex gap-3">
                    <button @click="resetData()" class="flex-1 py-3 bg-white border border-slate-200 text-slate-600 rounded-xl hover:bg-slate-50 font-medium text-sm transition-all shadow-sm">
                        Reset
                    </button>
                    <button @click="showReport = true" class="flex-1 py-3 bg-brand-600 text-white rounded-xl hover:bg-brand-700 font-medium text-sm transition-all shadow-md shadow-brand-500/30 flex items-center justify-center gap-2">
                        <span>Finish & Report</span> <i class="fa-solid fa-arrow-right"></i>
                    </button>
                </div>

            </div>
        </div>
    </main>

    <div x-show="showReport" class="fixed inset-0 z-50 flex items-center justify-center p-4 modal-ui" x-cloak>
        <div class="absolute inset-0 bg-slate-900/60 backdrop-blur-sm" @click="showReport = false" x-transition.opacity></div>
        
        <div class="bg-white w-full max-w-5xl rounded-2xl shadow-2xl overflow-hidden flex flex-col max-h-[90vh] relative z-10 transform transition-all" x-transition.scale.origin.bottom>
            
            <div class="bg-white px-8 py-5 border-b border-slate-100 flex justify-between items-center">
                <div class="flex items-center gap-3">
                    <div class="bg-brand-100 text-brand-600 p-2 rounded-lg"><i class="fa-solid fa-wand-magic-sparkles text-lg"></i></div>
                    <div>
                        <h2 class="text-xl font-bold text-slate-800">Report Generator</h2>
                        <p class="text-xs text-slate-500">Customize your final assessment document.</p>
                    </div>
                </div>
                <button @click="showReport = false" class="text-slate-400 hover:text-red-500 transition-colors"><i class="fa-solid fa-xmark text-xl"></i></button>
            </div>
            
            <div class="p-8 overflow-y-auto flex-1 bg-slate-50">
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                    
                    <div class="space-y-6">
                        <div class="bg-white p-5 rounded-xl border border-slate-200 shadow-sm space-y-4">
                            <h3 class="text-sm font-bold text-slate-800 uppercase tracking-wide border-b pb-2">Client Details</h3>
                            <div>
                                <label class="text-xs font-bold text-slate-500">Ticket Reference</label>
                                <input type="text" x-model="report.ticketId" class="w-full mt-1 border-slate-200 rounded-lg text-sm focus:border-brand-500 focus:ring-brand-500" placeholder="e.g. INC-2401">
                            </div>
                            <div>
                                <label class="text-xs font-bold text-slate-500">Consultant Name</label>
                                <input type="text" x-model="report.engineer" class="w-full mt-1 border-slate-200 rounded-lg text-sm focus:border-brand-500 focus:ring-brand-500" placeholder="Your Name">
                            </div>
                        </div>
                        
                        <div class="bg-white p-5 rounded-xl border border-slate-200 shadow-sm flex flex-col items-center justify-center text-center">
                            <div style="height: 120px; width: 120px;">
                                <canvas id="scoreChart"></canvas>
                            </div>
                            <div class="mt-4">
                                <span class="text-3xl font-bold text-brand-600" x-text="Math.round((report.steps.length / totalItems) * 100) + '%'"></span>
                                <p class="text-xs text-slate-500 uppercase">Compliance Score</p>
                            </div>
                        </div>
                    </div>

                    <div class="lg:col-span-2 space-y-6">
                        <div class="bg-white p-5 rounded-xl border border-slate-200 shadow-sm relative overflow-hidden">
                            <div class="absolute top-0 left-0 w-1 h-full bg-red-500"></div>
                            <h3 class="text-sm font-bold text-red-600 uppercase tracking-wide mb-3 flex items-center">
                                <i class="fa-solid fa-triangle-exclamation mr-2"></i> Key Pain Points & Risks
                            </h3>
                            <textarea x-model="report.painPoints" class="w-full h-24 p-3 bg-red-50/50 border border-red-100 rounded-lg text-sm focus:ring-2 focus:ring-red-100 outline-none resize-none" placeholder="- Legacy authentication is enabled (High Risk)&#10;- Admin accounts are not using MFA"></textarea>
                        </div>

                        <div class="bg-white p-5 rounded-xl border border-slate-200 shadow-sm relative overflow-hidden">
                            <div class="absolute top-0 left-0 w-1 h-full bg-brand-500"></div>
                            <div class="flex justify-between items-center mb-3">
                                <h3 class="text-sm font-bold text-brand-600 uppercase tracking-wide flex items-center">
                                    <i class="fa-solid fa-shield-halved mr-2"></i> Strategic Recommendations
                                </h3>
                                <div class="flex gap-1">
                                    <button @click="addRec('Enable MFA')" class="px-2 py-1 text-[10px] bg-brand-50 text-brand-700 rounded border border-brand-200 hover:bg-brand-100 transition-colors">+ MFA</button>
                                    <button @click="addRec('Block Legacy')" class="px-2 py-1 text-[10px] bg-brand-50 text-brand-700 rounded border border-brand-200 hover:bg-brand-100 transition-colors">+ Legacy</button>
                                </div>
                            </div>
                            <textarea x-model="report.recommendations" class="w-full h-24 p-3 bg-brand-50/50 border border-brand-100 rounded-lg text-sm focus:ring-2 focus:ring-brand-100 outline-none resize-none" placeholder="Enter recommendations..."></textarea>
                        </div>

                        <div class="bg-white p-5 rounded-xl border border-slate-200 shadow-sm relative overflow-hidden">
                            <div class="absolute top-0 left-0 w-1 h-full bg-green-500"></div>
                            <div class="flex justify-between items-center mb-3">
                                <h3 class="text-sm font-bold text-green-600 uppercase tracking-wide flex items-center">
                                    <i class="fa-solid fa-map mr-2"></i> Roadmap
                                </h3>
                                <button @click="addPlan('Security Hardening')" class="text-xs text-green-700 hover:underline">Auto-Fill Standard Plan</button>
                            </div>
                            <textarea x-model="report.projectPlan" class="w-full h-32 p-3 bg-green-50/50 border border-green-100 rounded-lg text-sm font-mono focus:ring-2 focus:ring-green-100 outline-none resize-none" placeholder="Phase 1: ..."></textarea>
                        </div>
                    </div>

                </div>
            </div>

            <div class="bg-white px-8 py-5 border-t border-slate-100 flex justify-end gap-3">
                <button @click="showReport = false" class="px-6 py-2.5 rounded-lg text-slate-500 font-medium hover:bg-slate-50 transition-colors">Back</button>
                <button @click="preparePrint()" class="px-8 py-2.5 bg-brand-600 text-white rounded-lg font-bold hover:bg-brand-700 shadow-lg shadow-brand-500/30 transition-all flex items-center gap-2">
                    <i class="fa-solid fa-print"></i> Generate PDF
                </button>
            </div>
        </div>
    </div>

    <div id="print-template">
        
        <div class="print-page">
            <div class="doc-header">
                <div>
                    <h1 class="doc-title">Security Assessment Report</h1>
                    <p class="doc-subtitle">Microsoft Entra ID & M365 Environment</p>
                </div>
                <div class="text-right">
                    <div class="text-xs uppercase tracking-widest text-slate-400 mb-1">Generated Date</div>
                    <div class="font-bold text-lg" x-text="new Date().toLocaleDateString('th-TH')"></div>
                </div>
            </div>

            <div class="info-grid">
                <div class="info-card">
                    <span class="text-xs font-bold text-slate-400 uppercase">Ticket ID</span>
                    <div class="font-bold text-lg" x-text="report.ticketId || '-'"></div>
                </div>
                <div class="info-card">
                    <span class="text-xs font-bold text-slate-400 uppercase">Consultant</span>
                    <div class="font-bold text-lg" x-text="report.engineer || '-'"></div>
                </div>
            </div>

            <div class="section-head"><i class="fa-solid fa-chart-pie mr-2"></i> Executive Summary</div>
            <div class="chart-container-print">
                <div class="chart-box" style="flex: 1;">
                    <div style="position: relative; height: 140px; width: 140px;">
                        <canvas id="printScoreChart"></canvas>
                        <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); text-align: center;">
                            <div style="font-size: 18pt; font-weight: bold; color: #0284c7;" x-text="Math.round((report.steps.length / totalItems) * 100) + '%'"></div>
                        </div>
                    </div>
                </div>
                <div class="chart-box" style="flex: 1.5; align-items: flex-end; padding-bottom: 0;">
                    <div style="height: 150px; width: 100%;">
                        <canvas id="printCategoryChart"></canvas>
                    </div>
                </div>
            </div>

            <div class="section-head"><i class="fa-solid fa-magnifying-glass mr-2"></i> Findings & Recommendations</div>
            <div class="analysis-grid">
                <div class="finding-box pain">
                    <h4 class="text-red-700 font-bold mb-2 uppercase text-xs border-b border-red-200 pb-1">Critical Pain Points</h4>
                    <div style="white-space: pre-line;" x-text="report.painPoints"></div>
                </div>
                <div class="finding-box rec">
                    <h4 class="text-blue-700 font-bold mb-2 uppercase text-xs border-b border-blue-200 pb-1">Strategic Recommendations</h4>
                    <div style="white-space: pre-line;" x-text="report.recommendations"></div>
                </div>
            </div>

            <div class="section-head"><i class="fa-solid fa-road mr-2"></i> Implementation Roadmap</div>
            <div class="roadmap-box" x-text="report.projectPlan"></div>

            <div class="footer">Page 1/2 • Confidential Security Report • Generated by Entra ID Expert Tool</div>
        </div>

        <div class="print-page">
            <div class="doc-header">
                <div><h1 class="doc-title" style="font-size: 18pt;">Detailed Audit Log</h1></div>
            </div>

            <table class="audit-table">
                <thead>
                    <tr>
                        <th width="10%">No.</th>
                        <th width="70%">Checklist Item</th>
                        <th width="20%">Status</th>
                    </tr>
                </thead>
                <tbody>
                    <template x-for="(step, index) in report.steps">
                        <tr>
                            <td x-text="index + 1" style="color: #94a3b8; text-align: center;"></td>
                            <td x-text="step" style="font-weight: 500;"></td>
                            <td style="color: #16a34a; font-weight: bold;"><i class="fa-solid fa-check mr-1"></i> Pass</td>
                        </tr>
                    </template>
                    <tr x-show="report.steps.length === 0">
                        <td colspan="3" style="text-align: center; color: #cbd5e1; padding: 20px;">No items checked.</td>
                    </tr>
                </tbody>
            </table>

            <div style="margin-top: 50px; display: grid; grid-template-columns: 1fr 1fr; gap: 40px;">
                <div style="text-align: center;">
                    <div style="border-bottom: 1px solid #cbd5e1; height: 40px; width: 80%; margin: 0 auto;"></div>
                    <p style="margin-top: 10px; font-weight: bold;">Consultant Signature</p>
                </div>
                <div style="text-align: center;">
                    <div style="border-bottom: 1px solid #cbd5e1; height: 40px; width: 80%; margin: 0 auto;"></div>
                    <p style="margin-top: 10px; font-weight: bold;">Customer Acknowledgment</p>
                </div>
            </div>

            <div class="footer">Page 2/2 • Confidential Security Report • Generated by Entra ID Expert Tool</div>
        </div>
    </div>

    <script>
        let scoreChart, pScoreChart, pCatChart;

        function troubleshooter() {
            return {
                activeTab: 'securityChecklist', highlightedItem: null, showReport: false,
                report: { ticketId: '', engineer: '', steps: [], painPoints: '', recommendations: '', projectPlan: '' },
                
                recDatabase: { 'Enable MFA': "Enforce MFA for all users (Admins & Users).", 'Block Legacy': "Block Legacy Authentication (IMAP, POP, SMTP).", 'Global Admin': "Limit Global Administrators to < 5.", 'Shared Mailbox': "Block direct sign-in for Shared Mailboxes." },
                planDatabase: { 'Security Hardening': "Phase 1: Remediation (Week 1)\n- Enable MFA for all Admins.\n- Block Legacy Auth.\n\nPhase 2: Consolidation (Week 2)\n- Deploy Intune Compliance.\n- Enable Password Protection.\n\nPhase 3: Maintenance (Monthly)\n- Review PIM Roles." },

                tabs: [
                    { id: 'securityChecklist', label: 'Security Checklist', icon: 'fa-solid fa-shield-halved' },
                    { id: 'signin', label: 'Sign-in Issues', icon: 'fa-solid fa-arrow-right-to-bracket' },
                    { id: 'mfa', label: 'MFA Problems', icon: 'fa-solid fa-mobile-screen-button' },
                    { id: 'app', label: 'App / Device', icon: 'fa-solid fa-laptop-code' },
                    { id: 'sync', label: 'Sync Issues', icon: 'fa-solid fa-rotate' }
                ],
                content: {
                    securityChecklist: {
                        label: 'M365 Security Checklist', icon: 'fa-solid fa-shield-halved', link: 'https://www.infosec.ch/',
                        checklist: [
                            { text: 'Org: Monitor Secure Score', why: 'Quantifiable security posture.', guide: 'Check Secure Score dashboard.', steps: ['Entra > Protection > Secure Score.'] },
                            { text: 'Org: Limit Global Admins', why: 'Reduces attack surface.', guide: 'Keep GAs to 2-4 accounts.', steps: ['Roles & Admins > Global Admin.'] },
                            { text: 'Entra: Enforce MFA', why: 'Blocks 99.9% attacks.', guide: 'Use Conditional Access.', steps: ['CA Policy > Grant: Require MFA.'] },
                            { text: 'Entra: Block Legacy Auth', why: 'Prevents MFA bypass.', guide: 'Block older protocols.', steps: ['CA Policy > Block Legacy Clients.'] },
                            { text: 'Entra: Configure PIM', why: 'JIT Access.', guide: 'No permanent admins.', steps: ['Identity Governance > PIM.'] },
                            { text: 'M365: Block Shared Mailbox Sign-in', why: 'Unsecured entry.', guide: 'Delegation only.', steps: ['M365 Admin > Block Sign-in.'] }
                        ]
                    },
                    signin: { label: 'Sign-in Issues', icon: 'fa-solid fa-arrow-right-to-bracket', link: '', checklist: [{ text: 'Check Sign-in logs', why: 'Root cause.', guide: 'Analyze failure reason.', steps: ['Entra > Sign-in Logs.'] }] },
                    mfa: { label: 'MFA Problems', icon: 'fa-solid fa-mobile-screen-button', link: '', checklist: [{ text: 'Check Auth Methods', why: 'Registration status.', guide: 'Verify phone/app.', steps: ['Users > Auth Methods.'] }] },
                    app: { label: 'App / Device', icon: 'fa-solid fa-laptop-code', link: '', checklist: [{ text: 'Check Device Reg', why: 'Must be present.', guide: 'Search device.', steps: ['Entra > Devices.'] }] },
                    sync: { label: 'Sync Issues', icon: 'fa-solid fa-rotate', link: '', checklist: [{ text: 'Check Connect Health', why: 'Sync status.', guide: 'Monitor errors.', steps: ['Entra > Hybrid Health.'] }] }
                },
                get currentTabInfo() { return this.content[this.activeTab]; },
                get totalItems() { return Object.values(this.content).reduce((acc, c) => acc + c.checklist.length, 0); },
                changeTab(id) { this.activeTab = id; this.highlightedItem = null; },
                addRec(key) { this.report.recommendations = this.report.recommendations ? this.report.recommendations + "\n\n- " + this.recDatabase[key] : "- " + this.recDatabase[key]; },
                addPlan(key) { this.report.projectPlan = this.planDatabase[key]; },
                resetData() { if(confirm('Reset all data?')) { this.report.steps = []; this.report.painPoints = ''; this.report.recommendations = ''; this.report.projectPlan = ''; } },
                
                generateReport() { 
                    this.showReport = true; 
                    setTimeout(() => { 
                        const checked = this.report.steps.length; 
                        const ctx = document.getElementById('scoreChart'); 
                        if(ctx) { 
                            if(scoreChart) scoreChart.destroy(); 
                            scoreChart = new Chart(ctx, { 
                                type: 'doughnut', 
                                data: { labels: ['Compliant', 'Risk'], datasets: [{ data: [checked, this.totalItems - checked], backgroundColor: ['#0ea5e9', '#f1f5f9'], borderWidth: 0 }] }, 
                                options: { responsive: true, maintainAspectRatio: false, cutout: '75%', plugins: { legend: { display: false } } } 
                            }); 
                        } 
                    }, 100); 
                },
                
                preparePrint() { 
                    const checked = this.report.steps.length; 
                    const catData = Object.keys(this.content).map(k => this.content[k].checklist.filter(i => this.report.steps.includes(i.text)).length); 
                    const pCtx = document.getElementById('printScoreChart'); 
                    const bCtx = document.getElementById('printCategoryChart'); 
                    
                    if(pCtx) { 
                        if(pScoreChart) pScoreChart.destroy(); 
                        pScoreChart = new Chart(pCtx, { 
                            type: 'doughnut', 
                            data: { labels: ['Compliant', 'Risks'], datasets: [{ data: [checked, this.totalItems - checked], backgroundColor: ['#0284c7', '#e2e8f0'], borderWidth: 0 }] }, 
                            options: { responsive: true, maintainAspectRatio: false, cutout: '70%', plugins: { legend: { display: false } }, animation: { duration: 0 } } 
                        }); 
                    } 
                    if(bCtx) { 
                        if(pCatChart) pCatChart.destroy(); 
                        pCatChart = new Chart(bCtx, { 
                            type: 'bar', 
                            data: { labels: ['Sec.Check', 'Sign-in', 'MFA', 'App', 'Sync'], datasets: [{ label: 'Passed Items', data: catData, backgroundColor: '#0ea5e9', borderRadius: 4 }] }, 
                            options: { responsive: true, maintainAspectRatio: false, scales: { y: { beginAtZero: true, display: false }, x: { grid: { display: false } } }, plugins: { legend: { display: false } }, animation: { duration: 0 } } 
                        }); 
                    } 
                    setTimeout(() => window.print(), 500); 
                }
            }
        }
    </script>
</body>
</html>

```